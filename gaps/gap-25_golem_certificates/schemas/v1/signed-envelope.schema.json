{
  "$schema": "https://json-schema.org/draft-07/schema",
  "$id": "https://golem.network/schemas/v1/signed-envelop.schema.json",
  "title": "JSON signed envelope",
  "description": "JSON format of a signed envelop containing the signed data and its signature(s)",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string",
      "const": "https://golem.network/schemas/v1/signed-envelop.schema.json"
    },
    "signedData": {
      "description": "The JSON object that is being signed",
      "type": "object",
      "properties": {
        "$schema": {
          "description": "The schema defining the signed JSON object",
          "type": "string"
        }
      },
      "required": [ "$schema" ]
    },
    "signatures": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "algorithm": {
            "description": "Cryptographic algorithm used to calculate the signature",
            "type": "object",
            "properties": {
              "hash": {
                "description": "Cryptographic hash function used to create the signed fingerprint",
                "type": "string"
              },
              "encryption": {
                "description": "Cryptographic algorithm used to encrypt the fingerprint",
                "type": "string"
              }
            },
            "required": [ "hash", "encryption" ]
          },
          "signature": {
            "description": "Hexadecimal encoded string of the calculated signature",
            "type": "string",
            "format": "(0x)?[0-9a-fA-F]+"
          },
          "signer": {
            "description": "Information identifying the signing party with clear reference to the key required to verify the signature",
            "oneOf": [
              {
                "description": "For self signed certificates",
                "type": "string",
                "const": "self"
              },
              {
                "description": "Golem network certificate",
                "$ref": "signed-envelop.schema.json",
                "properties": {
                  "signedData": {
                    "$ref": "certificate.schema.json"
                  }
                }
              },
              {
                "description": "Other form of identification",
                "type": "object"
              }
            ]
          }
        },
        "required": [ "algorithm", "signature", "signer" ]
      },
      "minItems": 1,
      "uniqueItems": true
    }
  },
  "required": [ "$schema", "signedData", "signatures" ],
  "additionalProperties": false
}
